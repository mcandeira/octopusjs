/**
 * OctopusJS | v1.2.1 "Abyssal Octopus" üêô 
 * ------------------------------------
 * High-performance distributed intelligence frontend development framework.
 * * @author Miguel Candeira Carrera
 * @license MIT
 * @see {@link https://github.com/mcandeira/octopusjs}
 * @release Supervised and improved with the invaluable assistance of Gemini (Google AI).
 * * Characteristics:
 * - 12kB footprint (~3.8kB Gzipped)
 * - 0.07s LCP | 0.02s CLS
 * - Native ESM Architecture
 * * Copyright (c) 2026 Miguel Candeira Carrera
 * * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
 * -----------------------------------------------------
 */
var a={constant:{methodNotExist:"[Octopus] The HTMLElement method does not exist:",notHimself:'[Octopus] The "into" option requires a relative element different from himself.',unOverriddenValue:"[Octopus] The value cannot be overridden: ",unOverriddenHelper:"[Octopus] The helper cannot be overridden: ",unOverriddenAction:"[Octopus] The action cannot be overridden: ",unOverriddenProp:"[Octopus] The prop cannot be overridden: ",unOverriddenChild:"[Octopus] The child receiver cannot be overridden: ",parentPropNotFound:"[Octopus] Parent not found for prop: ",parentListenerNotFound:"[Octopus] Parent not found for listener: "},function:{validate(l,...t){let e=t.length;for(let n=0;n<e;n++){let[o,...i]=t[n];if(i.length===0)throw new Error(a.function.invalidValidateArguments(l.name,n+1));let r=!1;for(let s of i)if(s==null&&s===o||s&&Object(o)instanceof s){r=!0;break}if(!r){let s=o?.constructor?.name??typeof o,d=i.map(u=>u?.name??String(u)).join(" | ");throw new TypeError(a.function.invalidArgumentType(l.name,n+1,s,d))}}},invalidValidateArguments(l,t){return`[Octopus Error] Invalid validate arguments in: ${l}, parameter position '${t}'. Expected at least one value and one check type`},invalidArgumentType(l,t,e,n){return`[Octopus Error] Invalid argument type in: ${l}, parameter position '${t}'. Expected: ${n}, got ${e}.`}}};var c=class{static nerveRing=new Map;static registerData(t,e,n,o=!1){let i=this.nerveRing.get(`${t}::${e}`);if(!o&&i?.data!==void 0)return!1;let r=i?.__waiters?.filter(s=>s.remember);return this.nerveRing.set(`${t}::${e}`,{data:n,__waiters:r??[]}),i}static deliverData(t,e,n,o=!1){let i=this.nerveRing.get(`${t}::${e}`);return i?(i.data===void 0||o)&&i.__waiters.push({value:n,remember:o}):this.nerveRing.set(`${t}::${e}`,{data:void 0,__waiters:[{value:n,remember:o}]}),i}static registerValue(t,e,n=!1){a.function.validate(this.registerValue,[t,String],[n,Boolean]);let o=this.registerData("val",t,e,n);o===!1?console.warn(a.constant.unOverriddenValue,t):o&&o.__waiters?.forEach(i=>{i.value(e)})}static deliverValue(t,e,n=!0){a.function.validate(this.deliverValue,[t,String],[e,Function],[n,Boolean]);let o=this.deliverData("val",t,e,n);o?.data!==void 0&&e(o.data)}static registerProtected(t,e,n){a.function.validate(this.registerProtected,[t,String],[n,String]);let o=this.registerData("pro",`${t}::${n}`,e,!0);o&&o.__waiters?.forEach(i=>{i.value(e)})}static deliverProtected(t,e,n,o=!0){a.function.validate(this.deliverProtected,[t,String],[e,String],[n,Function],[o,Boolean]);let i=this.deliverData("pro",`${t}::${e}`,n,o);i?.data!==void 0&&n(i.data)}static registerHelper(t,e,n=!1){a.function.validate(this.registerHelper,[t,String],[e,Function],[n,Boolean]);let o=this.registerData("help",t,e,n);o===!1?console.warn(a.constant.unOverriddenHelper,t):o&&o.__waiters?.forEach(i=>{i.value(e)})}static deliverHelper(t,e,n=!1){a.function.validate(this.deliverHelper,[t,String],[e,Function],[n,Boolean]);let o=this.deliverData("help",t,e,n);o?.data!==void 0&&e(o.data)}static registerAction(t,e,n=!1){a.function.validate(this.registerAction,[t,String],[e,Function],[n,Boolean]);let o=this.registerData("act",t,e,n);o===!1?console.warn(a.constant.unOverriddenAction,t):o&&o.__waiters?.forEach(i=>{e(i.value)})}static triggerAction(t,e=void 0,n=!1){a.function.validate(this.triggerAction,[t,String],[n,Boolean]);let o=this.deliverData("act",t,e,n);o?.data!==void 0&&o.data(e)}static nerveCord=new WeakMap;static registerProp(t,e,n,o=!1){a.function.validate(this.registerProp,[t,Element],[e,String],[o,Boolean]);let i=this.nerveCord.get(t),r=i?.get(`direct::${e}`);if(!o&&r?.data!==void 0){console.warn(a.constant.unOverriddenProp,t,e);return}let s=r?.__waiters?.filter(d=>d.remember);i||(i=this.nerveCord.set(t,new Map).get(t)),i?.set(`direct::${e}`,{data:n,__waiters:s??[]}),r?.__waiters?.forEach(d=>{d.value(n)})}static deliverProp(t,e,n,o=!0){a.function.validate(this.deliverProp,[t,Element],[e,String],[n,Function],[o,Boolean]);let i=t.parentElement?.closest("*:has(> script.octopus)");if(!i){console.warn(a.constant.parentPropNotFound,t,e);return}let r=this.nerveCord.get(i),s=r?.get(`direct::${e}`);r||(r=this.nerveCord.set(i,new Map).get(i)),s?((s.data===void 0||o)&&s.__waiters.push({value:n,remember:o}),s.data!==void 0&&n(s.data)):r?.set(`direct::${e}`,{data:void 0,__waiters:[{value:n,remember:o}]})}static receiveChild(t,e,n,o=!1){a.function.validate(this.receiveChild,[t,Element],[e,String],[n,Function],[o,Boolean]);let i=this.nerveCord.get(t),r=i?.get(`inverse::${e}`);if(!o&&r?.data!==void 0){console.warn(a.constant.unOverriddenChild,t,e);return}let s=r?.__waiters?.filter(d=>d.remember);i||(i=this.nerveCord.set(t,new Map).get(t)),i?.set(`inverse::${e}`,{data:n,__waiters:s??[]}),r?.__waiters?.forEach(d=>{n(d.value)})}static sendParent(t,e,n=null,o=!1){a.function.validate(this.sendParent,[t,Element],[e,String],[o,Boolean]);let i=t.parentElement?.closest("*:has(> script.octopus)");if(!i){console.warn(a.constant.parentListenerNotFound,t,e);return}let r=this.nerveCord.get(i),s=r?.get(`inverse::${e}`);r||(r=this.nerveCord.set(i,new Map).get(i)),s?((s.data===void 0||o)&&s.__waiters.push({value:n,remember:o}),s.data!==void 0&&s.data(n)):r?.set(`inverse::${e}`,{data:void 0,__waiters:[{value:n,remember:o}]})}};var v=class l{static process(t){if(t=t.ref??t,Array.isArray(t)&&t.length===2){let e=t[0].ref??t[0];if(e instanceof Element)e=e.innerHTML;else if(typeof e!="string")throw new TypeError("[Octopus] Render Error: Invalid Template Argument");return this.stringToTemplate(this.processTemplate(e,t[1])).content}if(t instanceof Element)return this.stringToTemplate(t.innerHTML).content;if(typeof t=="string")return this.stringToTemplate(t).content;throw new TypeError("[Octopus] Render Error: Invalid Template Argument")}static#t=/\s+/;static#e=/\{\{([^}]+)\}\}/g;static directives={if(t,e,n){let o=t.contents[1];if(o?o.split(".").reduce((r,s)=>r?.[s],e):!1){let r=n.substring(t.ending,t.closeTag.starting);return this.processTemplate(r,e)}return""},for(t,e,n){let o=t.contents[3],i=o?o.split(".").reduce((r,s)=>r?.[s],e):null;if(Array.isArray(i)){let r=n.substring(t.ending,t.closeTag.starting),s=t.contents[1],d=[];for(let u of i){let g=Object.create(e);g[s]=u,d.push(l.processTemplate(r,g))}return d.join("")}return""}};static processTemplate(t,e){let n=[],o=0;try{for(;;){let r=this.getPairedTags("8{","}",t,o);if(!r){o<t.length&&n.push(t.substring(o));break}if(n.push(t.substring(o,r.starting)),!r.closeTag){console.warn(`[Octopus] Template Warning: Unclosed or unknown tag '${r.contents[0]}'`),n.push(t.substring(r.starting,r.ending)),o=r.ending;continue}let s=r.contents[0];this.directives[s]?n.push(this.directives[s](r,e,t)):n.push(t.substring(r.starting,r.closeTag.ending)),o=r.closeTag.ending}}catch(r){return console.error(r),`<div style="color:red; border:1px solid red; padding:10px;">Octopus Error: ${r.message}</div>`}return n.join("").replace(this.#e,(r,s)=>s.trim().split(".").reduce((u,g)=>u?.[g],e)??"")}static getPairedTags(t,e,n,o=0){let i=this.getTag(t,e,n,o);if(!i)return i;let r=i.contents[0];if(r!=="if"&&r!=="for")return i;let s=0,d=i.ending;for(;;){let u=this.getTag(t,e,n,d);if(!u)throw Error(`[Octopus] Template Syntax Error: Unclosed '${r}' tag starting at index ${i.starting}.`);switch(d=u.ending,u.contents[0]){case"if":case"for":s++;break;case"endif":if(s>0){s--;continue}if(r!=="if")throw Error(`[Octopus] Template Syntax Error: Unexpected 'endif' for '${r}' tag.`);i.closeTag=u;break;case"endfor":if(s>0){s--;continue}if(r!=="for")throw Error(`[Octopus] Template Syntax Error: Unexpected 'endfor' for '${r}' tag.`);i.closeTag=u;break}if(i.closeTag)break}return i}static getTag(t,e,n,o=0){let i=n.indexOf(t,o);if(i<0)return null;let r=n.indexOf(e,i);if(r<0)return null;let s=n.substring(i+t.length,r).trim().split(this.#t);return s.length<1||s[0]===""?null:{contents:s,starting:i,ending:r+e.length}}static stringToTemplate(t){let e=document.createElement("template");return e.innerHTML=t,this.fixScripts(e),e}static fixScripts(t){let e=t.content;for(let n of e.querySelectorAll("template"))this.fixScripts(n);for(let n of e.querySelectorAll("script")){let o=document.createElement("script");Array.from(n.attributes).forEach(i=>o.setAttribute(i.name,i.value)),o.type="module",o.textContent=n.textContent,n.replaceWith(o)}}};var b=Array.from(document.querySelectorAll("script.octopus")).reverse(),f=class l{_ref;constructor(t){let e=t===void 0?b.pop()?.parentElement:typeof t=="string"?document.querySelector(t):t;a.function.validate(this.constructor,[e,Element]),this._ref=e}get ref(){return this._ref}getChild(t){a.function.validate(this.getChild,[t,String]);let e=this._ref.querySelector(t);return e?new l(e):void 0}set(t,e){return a.function.validate(this.set,[t,String]),t in this._ref?this._ref[t]=e:this._ref.setAttribute(t,e),this}get(t){return a.function.validate(this.get,[t,String]),t in this._ref?this._ref[t]:this._ref.getAttribute(t)}use(t,...e){a.function.validate(this.use,[t,String]);let n=this._ref;if(typeof n[t]=="function")return n[t](...e);throw new Error(`${a.constant.methodNotExist}${t}`)}deleteAll(t){a.function.validate(this.deleteAll,[t,String]);let e=this._ref.querySelectorAll(t);for(let n of e)n.remove()}onMount(t){a.function.validate(this.onMount,[t,Function]),document.body.contains(this._ref)?t():new MutationObserver(([],e)=>{document.body.contains(this._ref)&&(t(),e.disconnect())}).observe(document.body,{childList:!0,subtree:!0})}onUnmount(t){a.function.validate(this.onUnmount,[t,Function]),new MutationObserver(([],e)=>{document.body.contains(this._ref)||(t(),e.disconnect())}).observe(document.body,{childList:!0,subtree:!0})}sendValue(t,e,n=!1){c.registerValue(t,e,n)}receiveValue(t,e,n=!0){c.deliverValue(t,e,n)}sendProtected(t,e,n){c.registerProtected(t,e,n)}receiveProtected(t,e,n,o=!0){c.deliverProtected(t,e,n,o)}sendHelper(t,e,n=!1){c.registerHelper(t,e,n)}receiveHelper(t,e){c.deliverHelper(t,e)}setAction(t,e,n=!1){c.registerAction(t,e,n)}triggerAction(t,e=void 0){c.triggerAction(t,e)}sendProp(t,e,n=!1){c.registerProp(this._ref,t,e,n)}receiveProp(t,e,n=!0){c.deliverProp(this._ref,t,e,n)}receiveChild(t,e,n=!1){c.receiveChild(this._ref,t,e,n)}sendParent(t,e){c.sendParent(this._ref,t,e)}render(t,e="default",n=this._ref){let o=v.process(t),i=n instanceof l?n._ref:n;switch(e){case"beforebegin":i.before(o);break;case"afterbegin":i.prepend(o);break;case"beforeend":i.append(o);break;case"afterend":i.after(o);break;case"into":if(i===this._ref)throw new Error(a.constant.notHimself);i.replaceChildren(o);break;default:i===this._ref?i.append(o):i.after(o)}}};var h=class{static getTemplates(){return`
            <div id="octopusTemplates">
                ${this.octopusDialogTemplate()}
            </div>
        `}static octopusDialogTemplate(){return`
            <template id="octopusDialogTemplate">
                <dialog id="{{ id }}" class="{{ classes }}">
                    <div>
                        {{ message }}
                        8{for option in options}
                            {{ option }}
                        8{endfor}
                        <button>Close</button>
                    </div>

                    <script type="module">
                        import { octopus } from 'octopus-js-native'

                        const component = octopus.getComponent('#{{ id }}')
                        const button = component.getChild('button')

                        button.use('addEventListener', 'click', () => {
                            component.use('close')
                            component.use('remove')
                        })
                    <\/script>

                    <style>
                        @scope{
                            >div{
                                display: flex;
                                flex-direction: column;
                            }
                        }
                    </style>
                </dialog>
            </template>
        `}};var p={constant:{requestError:"[Octopus] Request Error:",autoProcessError:"[Octopus] AutoProcess Error: Invalid data received.",dialogTemplateNotFound:'[Octopus] Dialog Error: Template "#octopusDialogTemplate" not found.'},function:{generateDialog(l,t,e="",n=void 0){let o=new f("body"),i=o.getChild("#octopusDialogTemplate");if(!i){console.warn(p.constant.dialogTemplateNotFound);return}l=`${l}Dialog`;let r=o.getChild(`#${l}`);r&&r.use("remove"),o.render([i,{message:t,classes:e,options:n,id:l}]),o.getChild(`#${l}`)?.use("showModal")}}};var m=class{constructor(t){if(!t||typeof t!="object"){console.error(p.constant.autoProcessError);return}if(t instanceof Error){p.function.generateDialog("error",t.message,"bg-danger");return}t.message&&p.function.generateDialog("message",t.message.content??t.message,t.message.classes,t.message.options),t.error&&p.function.generateDialog("error",t.error,"bg-danger")}};var y=class{url;data;constructor(t,e=void 0){this.url=t,this.data=e}get(t,e=t){let n=this.data?new URLSearchParams(this.data).toString():"",o=this.url.includes("?")?"&":"?",i=n?`${this.url}${o}${n}`:this.url;this.fetch(new Request(i),t,e)}post(t,e=t){this.fetch(new Request(this.url,{method:"POST",body:this.data}),t,e)}autoprocess(){this.post(t=>{new m(t)})}fetch(t,e,n){fetch(t).then(o=>{if(!o.ok)throw{error:`${p.constant.requestError} ${o.status} ${o.statusText}.`};let i=o.headers.get("Content-Type");return i&&i.includes("application/json")?o.json():o.text()}).then(o=>{e(o)}).catch(o=>{n(o)})}};var w=class{static takeControl(){let t=new f("body");t.render(h.getTemplates()),t.use("addEventListener","submit",e=>{e.preventDefault();let n=e.target;new y(n.action,new FormData(n)).autoprocess()})}};var T=class{constructor(){}static getComponent(t){return new f(t)}static registerValue(t,e,n=!1){c.registerValue(t,e,n)}static deliverValue(t,e,n=!0){c.deliverValue(t,e,n)}static registerProtected(t,e,n){c.registerProtected(t,e,n)}static deliverProtected(t,e,n,o=!0){c.deliverProtected(t,e,n,o)}static registerHelper(t,e,n=!1){c.registerHelper(t,e,n)}static deliverHelper(t,e,n=!1){c.deliverHelper(t,e,n)}static registerAction(t,e,n=!1){c.registerAction(t,e,n)}static triggerAction(t,e=void 0,n=!1){c.triggerAction(t,e,n)}static fullActive(){w.takeControl()}};export{T as octopus};
//# sourceMappingURL=octopus.min.js.map
