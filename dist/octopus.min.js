/**
 * OctopusJS | v1.1.4 "Abyssal Octopus" ðŸ™ 
 * ------------------------------------
 * High-performance distributed intelligence frontend development framework.
 * * @author Miguel Candeira Carrera
 * @license MIT
 * @see {@link https://github.com/mcandeira/octopusjs}
 * @release Supervised and improved with the invaluable assistance of Gemini (Google AI).
 * * Characteristics:
 * - 12kB footprint (~3.8kB Gzipped)
 * - 0.07s LCP | 0.02s CLS
 * - Native ESM Architecture
 * * Copyright (c) 2026 Miguel Candeira Carrera
 * * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
 * -----------------------------------------------------
 */
const octopusScripts=Array.from(document.querySelectorAll("script.octopus")).reverse();export class octopus{static getComponent(t){return new OctopusComponent(t)}static#t=new Map;static setVal(t,e,s=!1){s||!octopus.#t.has(t)?octopus.#t.set(t,e):console.warn(`[Octopus] The val "${t}" already exists.`)}static getVal(t){return octopus.#t.get(t)}static#e=new Map;static setHelper(t,e,s=!1){"function"==typeof e?s||!octopus.#e.has(t)?octopus.#e.set(t,e):console.warn(`[Octopus] The helper "${t}" already exists.`):console.warn(`[Octopus] The callback argument is not a function, in helper "${t}".`)}static getHelper(t){if(octopus.#e.has(t))return octopus.#e.get(t);console.warn(`[Octopus] The helper "${t}" doesn't exist.`)}static#s=new Map;static setAction(t,e,s=!1){"function"==typeof e?s||!octopus.#s.has(t)?octopus.#s.set(t,e):console.warn(`[Octopus] The action "${t}" already exists.`):console.warn(`[Octopus] The callback argument is not a function, in action "${t}".`)}static triggerAction(t,e=null){octopus.#s.has(t)?octopus.#s.get(t)(e):console.warn(`[Octopus] The action "${t}" doesn't exist.`)}static#o=new Map;static setSecret(t,e,s,o=!1){if(octopus.#o.has(t)){if(!octopus.#o.get(t)?.has(s)&&!o)return}else octopus.#o.set(t,new Map);octopus.#o.get(t).set(s,e)}static getSecret(t,e){const s=octopus.#o.get(t)?.get(e);if(s)return s;console.warn(`[Octopus] The secret "${t}" can't be accessed.`)}static fullActive(){const t=new OctopusComponent("body");t.render(OctopusTemplates.getTemplates()),t.use("addEventListener","submit",t=>{t.preventDefault(),new OctopusRequest(t.target.action,new FormData(t.target)).autoprocess()})}}class OctopusComponent{#n;constructor(t){if(t instanceof Element?this.#n=t:"string"==typeof t?this.#n=document.querySelector(t):void 0===t&&(this.#n=octopusScripts.pop()?.parentNode),!this.#n)throw new TypeError("[Octopus] Unexpected OctopusComponent Argument")}get ref(){return this.#n}getChild(t){const e=this.#n.querySelector(t);return e?new OctopusComponent(e):e}set(t,e){return this.#n[t]=e,this}get(t){return this.#n[t]}use(t,...e){if("function"==typeof this.#n[t])return this.#n[t](...e);throw Error(`The ${t} method does not exist.`)}deleteAll(t){for(let e of this.#n.querySelectorAll(t))e.remove()}onMount(t){document.body.contains(this.#n)?t():new MutationObserver((e,s)=>{document.body.contains(this.#n)&&(t(),s.disconnect())}).observe(document.body,{childList:!0,subtree:!0})}onUnmount(t){new MutationObserver((e,s)=>{document.body.contains(this.#n)||(t(),s.disconnect())}).observe(document.body,{childList:!0,subtree:!0})}setVal(t,e,s=!1){octopus.setVal(t,e,s)}getVal(t){return octopus.getVal(t)}setHelper(t,e,s=!1){octopus.setHelper(t,e,s)}getHelper(t){return octopus.getHelper(t)}setAction(t,e,s=!1){octopus.setAction(t,e,s)}triggerAction(t,e=null){octopus.triggerAction(t,e)}setSecret(t,e,s,o=!1){octopus.setSecret(t,e,s,o)}getSecret(t,e){return octopus.getSecret(t,e)}static#r=new WeakMap;setProp(t,e,s=!1){let o=OctopusComponent.#r;s||!o.get(this.#n)?.has(t)?(o.get(this.#n)||o.set(this.#n,new Map),o.get(this.#n).set(t,e)):console.warn(`[Octopus] The prop "${t}" already exists.`,this.#n)}getProp(t){const e=this.#n.closest("*:has(> script.octopus):not(:scope)");if(!e)return void console.warn(`[Octopus] Parent not found for prop "${t}"`,this.#n);let s=OctopusComponent.#r.get(e)?.get(t);if(void 0!==s)return s;console.warn(`[Octopus] The prop "${t}" doesn't exist.`,this.#n)}listenChild(t,e,s=!1){let o=OctopusComponent.#r,n=`childListener-${t}`;s||!o.get(this.#n)?.has(n)?(o.get(this.#n)||o.set(this.#n,new Map),o.get(this.#n).set(n,e)):console.warn(`[Octopus] The child listener "${n}" already exists.`,this.#n)}sendParent(t,e){let s=`childListener-${t}`;const o=this.#n.closest("*:has(> script.octopus):not(:scope)");if(!o)return void console.warn(`[Octopus] Parent not found for listener "${t}"`,this.#n);let n=OctopusComponent.#r.get(o)?.get(s);n?n(e):console.warn(`[Octopus] The child listener "${s}" doesn't exist.`,this.#n)}render(t,e="after",s){const o=OctopusComponent.#c(t).content,n=s?.ref??s;switch(e){case"into":if(!n)throw Error('The "into" option requires a relative element as the third argument');n.innerHTML="",n.append(o);break;case"before":n?n.before(o):this.ref.prepend(o);break;default:n?n.after(o):this.ref.append(o)}}static#c(t){if(t=t.ref??t,Array.isArray(t)&&2===t.length){let e=t[0].ref??t[0];if(e instanceof Element)e=e.innerHTML;else if("string"!=typeof e)throw new TypeError("[Octopus] Render Error: Invalid Template Argument");return OctopusTemplates.stringToTemplate(OctopusTemplates.processTemplate(e,t[1]))}if(t instanceof Element)return OctopusTemplates.stringToTemplate(t.innerHTML);if("string"==typeof t)return OctopusTemplates.stringToTemplate(t);throw new TypeError("[Octopus] Render Error: Invalid Template Argument")}}class OctopusRequest{constructor(t,e=null){this.url=t,this.data=e}get(t,e=t){this.#i(new Request(`${this.url}${this.data?"?"+new URLSearchParams(this.data):""}`),t,e)}post(t,e=t){this.#i(new Request(this.url,{method:"POST",body:this.data}),t,e)}autoprocess(){this.post(t=>{new OctopusAutoProcess(t)})}#i(t,e,s){fetch(t).then(t=>{if(!t.ok)throw{error:`[Octopus] Request Error: ${t.status} ${t.statusText}.`};const e=t.headers.get("Content-Type");return e&&e.includes("application/json")?t.json():t.text()}).then(t=>{e(t)}).catch(t=>{s(t)})}}class OctopusAutoProcess{constructor(t){t?(t.message&&OctopusFunctions.generateDialog("message",t.message.content,t.message.classes,t.message.options),t.error&&OctopusFunctions.generateDialog("error",t.error,"bg-danger")):console.warn("[Octopus] AutoProcess Error: No data received.")}}class OctopusTemplates{static#a=/\s+/;static#p=/\{\{([^}]+)\}\}/g;static directives={if(t,e,s){const o=t.contents[1];if(!!o&&o.split(".").reduce((t,e)=>t?.[e],e)){const o=s.substring(t.ending,t.closeTag.starting);return OctopusTemplates.processTemplate(o,e)}return""},for(t,e,s){const o=t.contents[3],n=o?o.split(".").reduce((t,e)=>t?.[e],e):null;if(Array.isArray(n)){const o=s.substring(t.ending,t.closeTag.starting),r=t.contents[1],c=[];for(let t of n){let s=Object.create(e);s[r]=t,c.push(OctopusTemplates.processTemplate(o,s))}return c.join("")}return""}};static processTemplate(t,e){const s=[];let o=0;try{for(;;){const n=OctopusTemplates.getPairedTags("8{","}",t,o);if(!n){o<t.length&&s.push(t.substring(o));break}if(s.push(t.substring(o,n.starting)),!n.closeTag){console.warn(`[Octopus] Template Warning: Unclosed or unknown tag '${n.contents[0]}'`),s.push(t.substring(n.starting,n.ending)),o=n.ending;continue}const r=n.contents[0];OctopusTemplates.directives[r]?s.push(OctopusTemplates.directives[r](n,e,t)):s.push(t.substring(n.starting,n.closeTag.ending)),o=n.closeTag.ending}}catch(t){return console.error(t),`<div style="color:red; border:1px solid red; padding:10px;">Octopus Error: ${t.message}</div>`}return s.join("").replace(OctopusTemplates.#p,(t,s)=>s.trim().split(".").reduce((t,e)=>t?.[e],e)??"")}static getPairedTags(t,e,s,o=0){let n=OctopusTemplates.getTag(t,e,s,o);if(!n)return n;let r=n.contents[0];if("if"!==r&&"for"!==r)return n;let c=0,i=n.ending;for(;;){let o=OctopusTemplates.getTag(t,e,s,i);if(!o)throw Error(`[Octopus] Template Syntax Error: Unclosed '${r}' tag starting at index ${n.starting}.`);switch(i=o.ending,o.contents[0]){case"if":case"for":c++;break;case"endif":if(c>0){c--;continue}if("if"!==r)throw Error(`[Octopus] Template Syntax Error: Unexpected 'endif' for '${r}' tag.`);n.closeTag=o;break;case"endfor":if(c>0){c--;continue}if("for"!==r)throw Error(`[Octopus] Template Syntax Error: Unexpected 'endfor' for '${r}' tag.`);n.closeTag=o}if(n.closeTag)break}return n}static getTag(t,e,s,o=0){const n=s.indexOf(t,o);if(n<0)return null;const r=s.indexOf(e,n);if(r<0)return null;const c=s.substring(n+t.length,r).trim().split(OctopusTemplates.#a);return c.length<1||""===c[0]?null:{contents:c,starting:n,ending:r+e.length}}static stringToTemplate(t){let e=document.createElement("template");return e.innerHTML=t,OctopusTemplates.fixScripts(e),e}static fixScripts(t){const e=t.content;for(const t of e.querySelectorAll("template"))OctopusTemplates.fixScripts(t);for(const t of e.querySelectorAll("script")){const e=document.createElement("script");Array.from(t.attributes).forEach(t=>e.setAttribute(t.name,t.value)),e.type="module",e.textContent=t.textContent,t.replaceWith(e)}}static getTemplates(){return`\n            <div id="octopusTemplates">\n                ${this.#l()}\n            </div>\n        `}static#l(){return"\n            <template id=\"octopusDialogTemplate\">\n                <dialog id=\"{{ dialogID }}\" class=\"{{ classes }}\">\n                    <div>\n                        {{ message }}\n                        8{for option in options}\n                            {{ option }}\n                        8{endfor}\n                        <button>Close</button>\n                    </div>\n\n                    <script type=\"module\">\n                        import { octopus } from 'octopus-js-native'\n\n                        const component = octopus.getComponent('#{{ dialogID }}')\n                        const button = component.getChild('button')\n\n                        button.use('addEventListener', 'click', () => {\n                            component.use('close')\n                            component.use('remove')\n                        })\n                    <\/script>\n\n                    <style>\n                        @scope{\n                            >div{\n                                display: flex;\n                                flex-direction: column;\n                            }\n                        }\n                    </style>\n                </dialog>\n            </template>\n        "}}class OctopusFunctions{static generateDialog(t,e,s,o=null){t=`${t}Dialog`;const n=new OctopusComponent("body"),r=n.getChild("#octopusDialogTemplate");if(!r)return void console.warn('[Octopus] Dialog Error: Template "#octopusDialogTemplate" not found.');const c=n.getChild(`#${t}`);c&&c.use("remove"),n.render([r,{message:e,classes:s,options:o,dialogID:t}]),n.getChild(`#${t}`)?.use("showModal")}}
//# sourceMappingURL=octopus.min.js.map